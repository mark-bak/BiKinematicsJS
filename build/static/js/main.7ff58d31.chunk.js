(this.webpackJsonpbikinematicsjs=this.webpackJsonpbikinematicsjs||[]).push([[0],{172:function(e,t,n){},312:function(e,t,n){},313:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n.n(a),r=n(32),i=n.n(r),o=(n(172),n(15)),s=(n(73),n(69)),l=n(315),d=n(316),u=n(320),j=n(160),b=n(161),h=n(72),f=n(163),g=n(2),O=function(e,t){return Object(s.a)(Array(Math.ceil(t)).keys()).map((function(n){return Math.round(n*(e/(t-1)))}))},p=function(e){return t=e,0===Object.keys(t).length?[]:m(e);var t},m=function(e){for(var t=[],n=0;n<Object.values(e)[0].length;n++){var a={};for(var c in e)a[c]=e[c][n];t.push(a)}return t};function v(e){var t=p(e.data),n=e.leverage_ratio_key,a=e.travel_key,c=e.anti_squat_key,r=t.length>0?t[t.length-1][a]:0;return Object(g.jsxs)("div",{style:{width:"100%"},children:[Object(g.jsx)("div",{className:"title",children:"Results:"}),Object(g.jsx)("div",{className:"description",children:"Leverage Ratio"}),Object(g.jsx)(l.a,{width:"100%",height:450,children:Object(g.jsxs)(d.a,{width:500,height:200,data:t,syncId:"anyId",margin:{top:10,right:30,left:0,bottom:0},children:[Object(g.jsx)(u.a,{strokeDasharray:"3 3"}),Object(g.jsx)(j.a,{type:"number",dataKey:a,domain:["auto","auto"],ticks:O(r,r/20+1)}),Object(g.jsx)(b.a,{type:"number",domain:["auto","auto"],allowDataOverflow:!0}),Object(g.jsx)(h.a,{labelFormatter:function(e){return"Travel: "+e},contentStyle:{color:"#E4C3AD","background-color":"#546A7B"},itemStyle:{color:"#E4C3AD"}}),Object(g.jsx)(f.a,{dataKey:n,stroke:"#8884d8",fill:"#8884d8",dot:!1})]})}),Object(g.jsx)("div",{className:"description",children:"Anti-Squat"}),Object(g.jsx)(l.a,{width:"100%",height:450,children:Object(g.jsxs)(d.a,{width:500,height:200,data:t,syncId:"anyId",margin:{top:10,right:30,left:0,bottom:0},children:[Object(g.jsx)(u.a,{strokeDasharray:"3 3"}),Object(g.jsx)(j.a,{type:"number",dataKey:a,domain:["auto","auto"],ticks:O(r,r/20+1)}),Object(g.jsx)(b.a,{type:"number",domain:["auto","auto"]}),Object(g.jsx)(h.a,{labelFormatter:function(e){return"Travel: "+e},contentStyle:{color:"#E4C3AD","background-color":"#546A7B"},itemStyle:{color:"#E4C3AD"}}),Object(g.jsx)(f.a,{dataKey:c,stroke:"#82ca9d",fill:"#82ca9d",dot:!1})]})})]})}var x=n(20),k=n(108),y=n.n(k);n(311);function _(e){var t=e.addLink,n=e.addShock,a=e.setSelect0,c=e.setSelect1,r=e.clearAll,i=e.params,o=e.setParams,s=e.changeFlag,l=e.setChangeFlag,d=Object(x.h)((function(e){return e.nodes})),u=Object(x.h)((function(e){return e.edges})),j=function(e,t){e.dataTransfer.setData("application/nodeType",t),e.dataTransfer.effectAllowed="move"},b=function(){return d.length?d.map((function(e){return{value:e.id,label:e.data.label}})):[]},h=function(e,t){var n=i;n[t]=parseFloat(e),o(n),l(!s)};return Object(g.jsxs)("aside",{children:[Object(g.jsx)("div",{className:"title",children:"Add Points:"}),Object(g.jsx)("div",{className:"description",children:"Drag to add"}),Object(g.jsx)("div",{className:"dndnode",onDragStart:function(e){return j(e,"linkage")},draggable:!0,children:"Linkage Point"}),Object(g.jsx)("div",{className:"dndnode",onDragStart:function(e){return j(e,"ground")},draggable:!0,children:"Ground Point"}),Object(g.jsx)("div",{className:"dndnode",onDragStart:function(e){return j(e,"rear_wheel")},draggable:!0,children:"Rear Wheel"}),Object(g.jsx)("div",{className:"dndnode",onDragStart:function(e){return j(e,"front_wheel")},draggable:!0,children:"Front Wheel"}),Object(g.jsx)("div",{className:"dndnode",onDragStart:function(e){return j(e,"bottom_bracket")},draggable:!0,children:"Bottom bracket"}),Object(g.jsx)("div",{className:"title",children:"Add links:"}),Object(g.jsx)(y.a,{className:"dropdown",placeholderClassName:"dropdown",controlClassName:"dropdown",menuClassName:"dropdown-menu",arrowClassName:"arrow",options:b(),onChange:function(e){return a(e.value)},value:"Select link",placeholder:"Select link"}),Object(g.jsx)(y.a,{className:"dropdown",placeholderClassName:"dropdown",controlClassName:"dropdown",menuClassName:"dropdown-menu",arrowClassName:"arrow",options:b(),onChange:function(e){return c(e.value)},value:"Select link",placeholder:"Select link"}),Object(g.jsx)("button",{className:"button",onClick:t,children:"Add Link!"}),Object(g.jsx)("button",{className:"button",onClick:n,children:"Add Shock!"}),Object(g.jsx)("div",{className:"title",children:"Clear Data:"}),Object(g.jsx)("button",{className:"button",onClick:r,children:"Clear"}),Object(g.jsx)("div",{children:d.map((function(e){return Object(g.jsxs)("div",{children:[e.id," ","\n","x: ",e.__rf.position.x.toFixed(2),", y: ",e.__rf.position.y.toFixed(2)]},e.id)}))}),Object(g.jsx)("div",{children:u.map((function(e){return Object(g.jsx)("div",{children:e.id},e.id)}))}),Object(g.jsx)("div",{children:Object(g.jsx)("input",{onChange:function(e){return h(e.target.value,"wheel_size")},placeholder:"Wheel Size (in)"})}),Object(g.jsx)("div",{children:Object(g.jsx)("input",{onChange:function(e){return h(e.target.value,"chainring_teeth")},placeholder:"Chainring Teeth"})}),Object(g.jsx)("div",{children:Object(g.jsx)("input",{onChange:function(e){return h(e.target.value,"cassette_teeth")},placeholder:"Cassette Teeth"})})]})}var w=Object(a.memo)((function(e){var t=e.data;return Object(g.jsxs)(g.Fragment,{children:[t.label,Object(g.jsx)(x.c,{isValidConnection:!0,position:"bottom",style:{border:"rgba(0,0,0,0)",width:"3px",height:"3px",backgroundColor:"rgb(255,0,0)"},isConnectable:!0})]})})),C=n(57);function S(e){var t=e.shock,n=e.reactFlowWrapper,c=e.setBikeData,r=e.changeFlag,i=e.params,o=Object(x.h)((function(e){return e.nodes})),l=Object(x.h)((function(e){return e.edges}));Object(a.useEffect)((function(){c(d(o,l,t,n.current.getBoundingClientRect().height))}),[r]);var d=function(e,t,n,a){return{points:Object.assign.apply(Object,[{}].concat(Object(s.a)(e.map((function(e){return Object(C.a)({},e.id,{name:e.id,type:e.type,pos:[e.__rf.position.x,a-e.__rf.position.y]})}))))),links:Object.assign.apply(Object,[{}].concat(Object(s.a)(t.map((function(e){return Object(C.a)({},e.id,{name:e.id,a:e.source,b:e.target})}))))),shock:n,params:{wheelbase:i.wheelbase,chainring_teeth:i.chainring_teeth,cassette_teeth:i.cassette_teeth,wheel_size:i.wheel_size,p2mm:1.3379530916844349,cog_height:i.cog_height}}};return null}n(312);var D=0,N=[];function F(e){var t=e.bikeData,n=e.setBikeData,c=e.clearBikeData,r=e.clearSolutionData,i=Object(a.useState)(null),s=Object(o.a)(i,2),l=s[0],d=s[1],u=Object(a.useState)(null),j=Object(o.a)(u,2),b=j[0],h=j[1],f=Object(a.useRef)(null),O=Object(a.useState)(null),p=Object(o.a)(O,2),m=p[0],v=p[1],k=Object(a.useState)(N),y=Object(o.a)(k,2),C=y[0],F=y[1],A=Object(a.useState)(""),B=Object(o.a)(A,2),T=B[0],R=B[1],E=Object(a.useState)(!0),I=Object(o.a)(E,2),L=I[0],P=I[1],z=Object(a.useState)({wheelbase:1255,chainring_teeth:30,cassette_teeth:52,wheel_size:29,p2mm:1.3379530916844349,cog_height:1100}),W=Object(o.a)(z,2),q=W[0],J=W[1];Object(a.useEffect)((function(){K(t)}),[t]);var K=function(e){if(F([]),null!==e){var t=f.current.getBoundingClientRect(),n=[],a=e.points,c=e.links;for(var r in a)n.push({id:a[r].name,type:a[r].type,position:{x:a[r].pos[0],y:t.height-a[r].pos[1]},style:{width:100},data:{label:Object(g.jsxs)(g.Fragment,{children:[" ",a[r].name," ","\n"," ",a[r].type," "]})}});F((function(e){return e.concat(n)}));var i=function(e){var t={id:c[e].name,source:c[e].a,target:c[e].b,type:"straight"};F((function(e){return Object(x.e)(t,e)}))};for(var o in c)i(o);R(e.shock)}},M={linkage:w,ground:w,rear_wheel:w,front_wheel:w,bottom_bracket:w};return Object(g.jsx)("div",{className:"dndflow",children:Object(g.jsxs)(x.d,{children:[Object(g.jsx)("div",{className:"reactflow-wrapper",ref:f,children:Object(g.jsxs)(x.f,{elements:C,onElementsRemove:function(e){return F((function(t){return Object(x.g)(e,t)}))},onLoad:function(e){return v(e)},onDrop:function(e){if(e.preventDefault(),m){var t=f.current.getBoundingClientRect(),n=e.dataTransfer.getData("application/nodeType"),a=m.project({x:e.clientX-t.x-50,y:e.clientY-t.y}),c="Point_".concat(D++),r={id:c,type:n,position:a,connectable:!0,style:{width:100},data:{label:Object(g.jsxs)(g.Fragment,{children:[" ",c," ","\n"," ",n," "]})}};F((function(e){return e.concat(r)}))}},onMouseUp:function(){P(!L)},onDragOver:function(e){e.preventDefault(),e.dataTransfer.dropEffect="move"},nodeTypes:M,children:[Object(g.jsx)(x.b,{}),Object(g.jsx)(x.a,{style:{backgroundImage:"",backgroundRepeat:"no-repeat",backgroundSize:"100% auto"}})]})}),Object(g.jsx)(_,{addLink:function(){if(l===b);else{var e={id:"".concat(l,"-").concat(b),source:l,target:b,type:"straight"};F((function(t){return Object(x.e)(e,t)}))}},addShock:function(){if(l===b);else{var e={id:"".concat(l,"-").concat(b),source:l,target:b,type:"straight",style:{stroke:"red"}};F((function(t){return Object(x.e)(e,t)})),R(e.id)}},clearAll:function(){c(),r(),F([])},setSelect0:d,setSelect1:h,params:q,setParams:J,changeFlag:L,setChangeFlag:P}),Object(g.jsx)(S,{bikeData:t,setBikeData:n,changeFlag:L,shock:T,reactFlowWrapper:f,params:q})]})})}function A(e){var t=e.fetchBikeData;e.clearBikeData,e.clearSolutionData;return Object(g.jsxs)("div",{class:"top",children:[Object(g.jsx)("button",{className:"top-button",onClick:t,children:"Load Example"}),Object(g.jsx)("button",{className:"top-button",children:"Choose Image"})]})}var B=function(){var e=Object(a.useState)(null),t=Object(o.a)(e,2),n=t[0],c=t[1],r=Object(a.useState)({}),i=Object(o.a)(r,2),s=i[0],l=i[1],d=["LeverageRatio","AntiSquatPercent","VerticalTravel"];Object(a.useEffect)((function(){console.log(n),u()}),[n]);var u=function(){fetch("/api/solve?bike_data=".concat(encodeURIComponent(JSON.stringify(n)),"&sim_travel=").concat(encodeURIComponent(170),"&desired_outputs=").concat(encodeURIComponent(JSON.stringify(d)))).then((function(e){return e.json()})).then((function(e){return l(e)}))};return Object(g.jsx)("div",{className:"App",children:Object(g.jsxs)("div",{class:"grid-container",children:[Object(g.jsx)(A,{fetchBikeData:function(){fetch("/api/getbikedata").then((function(e){return e.json()})).then((function(e){c(e)}))}}),Object(g.jsx)("div",{class:"left",children:Object(g.jsx)(F,{bikeData:n,setBikeData:c,clearBikeData:function(){c(null)},clearSolutionData:function(){l({})}})}),Object(g.jsx)("div",{class:"right",children:Object(g.jsx)(v,{data:s,leverage_ratio_key:d[0],anti_squat_key:d[1],travel_key:d[2]})})]})})},T=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,322)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,r=t.getLCP,i=t.getTTFB;n(e),a(e),c(e),r(e),i(e)}))};i.a.render(Object(g.jsx)(c.a.StrictMode,{children:Object(g.jsx)(B,{})}),document.getElementById("root")),T()},73:function(e,t,n){}},[[313,1,2]]]);
//# sourceMappingURL=main.7ff58d31.chunk.js.map