(this.webpackJsonpbikinematicsjs=this.webpackJsonpbikinematicsjs||[]).push([[0],{172:function(e,t,n){},312:function(e,t,n){},313:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n.n(a),r=n(32),o=n.n(r),i=(n(172),n(15)),s=(n(73),n(69)),l=n(315),d=n(316),u=n(320),j=n(160),b=n(161),h=n(72),f=n(163),g=n(2),O=function(e,t){return Object(s.a)(Array(Math.ceil(t)).keys()).map((function(n){return Math.round(n*(e/(t-1)))}))},p=function(e){return t=e,0===Object.keys(t).length?[]:m(e);var t},m=function(e){for(var t=[],n=0;n<Object.values(e)[0].length;n++){var a={};for(var c in e)a[c]=e[c][n];t.push(a)}return t};function x(e){var t=p(e.data),n=e.leverage_ratio_key,a=e.travel_key,c=e.anti_squat_key,r=t.length>0?t[t.length-1][a]:0;return Object(g.jsxs)("div",{style:{width:"100%"},children:[Object(g.jsx)("div",{className:"title",children:"Results:"}),Object(g.jsx)("div",{className:"description",children:"Leverage Ratio"}),Object(g.jsx)(l.a,{width:"100%",height:450,children:Object(g.jsxs)(d.a,{width:500,height:200,data:t,syncId:"anyId",margin:{top:10,right:30,left:0,bottom:0},children:[Object(g.jsx)(u.a,{strokeDasharray:"3 3"}),Object(g.jsx)(j.a,{type:"number",dataKey:a,domain:["auto","auto"],ticks:O(r,r/20+1)}),Object(g.jsx)(b.a,{type:"number",domain:["auto","auto"],allowDataOverflow:!0}),Object(g.jsx)(h.a,{formatter:function(e){return Math.round(100*e)/100},labelFormatter:function(e){return"Travel: "+Math.round(100*e)/100},contentStyle:{color:"#E4C3AD","background-color":"#546A7B"},itemStyle:{color:"#E4C3AD"}}),Object(g.jsx)(f.a,{dataKey:n,stroke:"#8884d8",fill:"#8884d8",dot:!1})]})}),Object(g.jsx)("div",{className:"description",children:"Anti-Squat"}),Object(g.jsx)(l.a,{width:"100%",height:450,children:Object(g.jsxs)(d.a,{width:500,height:200,data:t,syncId:"anyId",margin:{top:10,right:30,left:0,bottom:0},children:[Object(g.jsx)(u.a,{strokeDasharray:"3 3"}),Object(g.jsx)(j.a,{type:"number",dataKey:a,domain:["auto","auto"],ticks:O(r,r/20+1)}),Object(g.jsx)(b.a,{type:"number",domain:["auto","auto"]}),Object(g.jsx)(h.a,{formatter:function(e){return Math.round(100*e)/100},labelFormatter:function(e){return"Travel: "+Math.round(100*e)/100},contentStyle:{color:"#E4C3AD","background-color":"#546A7B"},itemStyle:{color:"#E4C3AD"}}),Object(g.jsx)(f.a,{dataKey:c,stroke:"#82ca9d",fill:"#82ca9d",dot:!1})]})})]})}var v=n(20),k=n(108),y=n.n(k);n(311);function C(e){var t=e.addLink,n=e.addShock,a=e.setSelect0,c=e.setSelect1,r=e.clearAll,o=e.params,i=e.setParams,s=e.changeFlag,l=e.setChangeFlag,d=Object(v.h)((function(e){return e.nodes})),u=Object(v.h)((function(e){return e.edges})),j=function(e,t){e.dataTransfer.setData("application/nodeType",t),e.dataTransfer.effectAllowed="move"},b=function(){return d.length?d.map((function(e){return{value:e.id,label:e.data.label}})):[]},h=function(e,t){var n=o;n[t]=parseFloat(e),i(n),l(!s)};return Object(g.jsxs)("aside",{children:[Object(g.jsx)("div",{className:"title",children:"Add Points:"}),Object(g.jsx)("div",{className:"description",children:"Drag to add"}),Object(g.jsx)("div",{className:"dndnode",onDragStart:function(e){return j(e,"linkage")},draggable:!0,children:"Linkage Point"}),Object(g.jsx)("div",{className:"dndnode",onDragStart:function(e){return j(e,"ground")},draggable:!0,children:"Ground Point"}),Object(g.jsx)("div",{className:"dndnode",onDragStart:function(e){return j(e,"rear_wheel")},draggable:!0,children:"Rear Wheel"}),Object(g.jsx)("div",{className:"dndnode",onDragStart:function(e){return j(e,"front_wheel")},draggable:!0,children:"Front Wheel"}),Object(g.jsx)("div",{className:"dndnode",onDragStart:function(e){return j(e,"bottom_bracket")},draggable:!0,children:"Bottom bracket"}),Object(g.jsx)("div",{className:"title",children:"Add links:"}),Object(g.jsx)(y.a,{className:"dropdown",placeholderClassName:"dropdown",controlClassName:"dropdown",menuClassName:"dropdown-menu",arrowClassName:"arrow",options:b(),onChange:function(e){return a(e.value)},value:"Select link",placeholder:"Select link"}),Object(g.jsx)(y.a,{className:"dropdown",placeholderClassName:"dropdown",controlClassName:"dropdown",menuClassName:"dropdown-menu",arrowClassName:"arrow",options:b(),onChange:function(e){return c(e.value)},value:"Select link",placeholder:"Select link"}),Object(g.jsx)("button",{className:"button",onClick:t,children:"Add Link!"}),Object(g.jsx)("button",{className:"button",onClick:n,children:"Add Shock!"}),Object(g.jsx)("div",{className:"title",children:"Clear Data:"}),Object(g.jsx)("button",{className:"button",onClick:r,children:"Clear"}),Object(g.jsx)("div",{children:d.map((function(e){return Object(g.jsxs)("div",{children:[e.id," ","\n","x: ",e.__rf.position.x.toFixed(2),", y: ",e.__rf.position.y.toFixed(2)]},e.id)}))}),Object(g.jsx)("div",{children:u.map((function(e){return Object(g.jsx)("div",{children:e.id},e.id)}))}),Object(g.jsx)("div",{children:Object(g.jsx)("input",{onChange:function(e){return h(e.target.value,"wheel_size")},placeholder:"Wheel Size (in)"})}),Object(g.jsx)("div",{children:Object(g.jsx)("input",{onChange:function(e){return h(e.target.value,"chainring_teeth")},placeholder:"Chainring Teeth"})}),Object(g.jsx)("div",{children:Object(g.jsx)("input",{onChange:function(e){return h(e.target.value,"cassette_teeth")},placeholder:"Cassette Teeth"})})]})}var _=Object(a.memo)((function(e){var t=e.data;return Object(g.jsxs)(g.Fragment,{children:[t.label,Object(g.jsx)(v.c,{isValidConnection:!0,position:"bottom",style:{border:"rgba(0,0,0,0)",width:"3px",height:"3px",backgroundColor:"rgb(255,0,0)"},isConnectable:!0})]})})),w=n(57);function S(e){var t=e.shock,n=e.reactFlowWrapper,c=e.setBikeData,r=e.changeFlag,o=e.params,i=Object(v.h)((function(e){return e.nodes})),l=Object(v.h)((function(e){return e.edges}));Object(a.useEffect)((function(){c(d(i,l,t,n.current.getBoundingClientRect().height))}),[r]);var d=function(e,t,n,a){return{points:Object.assign.apply(Object,[{}].concat(Object(s.a)(e.map((function(e){return Object(w.a)({},e.id,{name:e.id,type:e.type,pos:[e.__rf.position.x,a-e.__rf.position.y]})}))))),links:Object.assign.apply(Object,[{}].concat(Object(s.a)(t.map((function(e){return Object(w.a)({},e.id,{name:e.id,a:e.source,b:e.target})}))))),shock:n,params:{wheelbase:o.wheelbase,chainring_teeth:o.chainring_teeth,cassette_teeth:o.cassette_teeth,wheel_size:o.wheel_size,cog_height:o.cog_height}}};return null}n(312);var D=0,N=[];function F(e){var t=e.bikeData,n=e.setBikeData,c=e.clearBikeData,r=e.clearSolutionData,o=e.debug,s=Object(a.useState)(null),l=Object(i.a)(s,2),d=l[0],u=l[1],j=Object(a.useState)(null),b=Object(i.a)(j,2),h=b[0],f=b[1],O=Object(a.useRef)(null),p=Object(a.useState)(null),m=Object(i.a)(p,2),x=m[0],k=m[1],y=Object(a.useState)(N),w=Object(i.a)(y,2),F=w[0],B=w[1],A=Object(a.useState)(""),E=Object(i.a)(A,2),R=E[0],T=E[1],L=Object(a.useState)(!0),I=Object(i.a)(L,2),P=I[0],M=I[1],z=Object(a.useState)({wheelbase:1255,chainring_teeth:30,cassette_teeth:52,wheel_size:29,cog_height:1100}),U=Object(i.a)(z,2),W=U[0],q=U[1];Object(a.useEffect)((function(){J(t)}),[t]);var J=function(e){if(B([]),null!==e){var t=O.current.getBoundingClientRect(),n=[],a=e.points,c=e.links;for(var r in a)n.push({id:a[r].name,type:a[r].type,position:{x:a[r].pos[0],y:t.height-a[r].pos[1]},style:{width:100},data:{label:Object(g.jsxs)(g.Fragment,{children:[" ",a[r].name," ","\n"," ",a[r].type," "]})}});B((function(e){return e.concat(n)}));var o=function(e){var t={id:c[e].name,source:c[e].a,target:c[e].b,type:"straight"};B((function(e){return Object(v.e)(t,e)}))};for(var i in c)o(i);T(e.shock)}},K={linkage:_,ground:_,rear_wheel:_,front_wheel:_,bottom_bracket:_};return Object(g.jsx)("div",{className:"dndflow",children:Object(g.jsxs)(v.d,{children:[o?Object(g.jsx)(C,{addLink:function(){if(d===h);else{var e={id:"".concat(d,"-").concat(h),source:d,target:h,type:"straight"};B((function(t){return Object(v.e)(e,t)}))}},addShock:function(){if(d===h);else{var e={id:"".concat(d,"-").concat(h),source:d,target:h,type:"straight",style:{stroke:"red"}};B((function(t){return Object(v.e)(e,t)})),T(e.id)}},clearAll:function(){c(),r(),B([])},setSelect0:u,setSelect1:f,params:W,setParams:q,changeFlag:P,setChangeFlag:M}):null,Object(g.jsx)("div",{className:"reactflow-wrapper",ref:O,children:Object(g.jsxs)(v.f,{elements:F,onElementsRemove:function(e){return B((function(t){return Object(v.g)(e,t)}))},onLoad:function(e){return k(e)},onDrop:function(e){if(e.preventDefault(),x){var t=O.current.getBoundingClientRect(),n=e.dataTransfer.getData("application/nodeType"),a=x.project({x:e.clientX-t.x-50,y:e.clientY-t.y}),c="Point_".concat(D++),r={id:c,type:n,position:a,connectable:!0,style:{width:100},data:{label:Object(g.jsxs)(g.Fragment,{children:[" ",c," ","\n"," ",n," "]})}};B((function(e){return e.concat(r)}))}},onMouseUp:function(){M(!P)},onDragOver:function(e){e.preventDefault(),e.dataTransfer.dropEffect="move"},nodeTypes:K,children:[Object(g.jsx)(v.b,{}),Object(g.jsx)(v.a,{style:{backgroundImage:"",backgroundRepeat:"no-repeat",backgroundSize:"100% auto"}})]})}),Object(g.jsx)(S,{bikeData:t,setBikeData:n,changeFlag:P,shock:R,reactFlowWrapper:O,params:W})]})})}function B(e){var t=e.fetchBikeData,n=(e.clearBikeData,e.clearSolutionData,e.setDebug),a=e.debug;return Object(g.jsxs)("div",{class:"top",children:[Object(g.jsx)("button",{className:"top-button",onClick:function(){t(1)},children:"Load Example 1"}),Object(g.jsx)("button",{className:"top-button",onClick:function(){t(2)},children:"Load Example 2"}),Object(g.jsx)("button",{className:"top-button",onClick:function(){t(3)},children:"Load Example 3"}),Object(g.jsx)("button",{className:"top-button",onClick:function(){t(4)},children:"Load Example 4"}),Object(g.jsx)("button",{className:"top-button",children:"Choose Image"}),Object(g.jsxs)("button",{className:"top-button",onClick:function(){return n(!a)},children:["DEBUG ",a?Object(g.jsx)(g.Fragment,{children:"on"}):Object(g.jsx)(g.Fragment,{children:"off"})]})]})}var A=function(){var e=Object(a.useState)(null),t=Object(i.a)(e,2),n=t[0],c=t[1],r=Object(a.useState)({}),o=Object(i.a)(r,2),s=o[0],l=o[1],d=Object(a.useState)(!1),u=Object(i.a)(d,2),j=u[0],b=u[1],h=["LeverageRatio","AntiSquatPercent","VerticalTravel"];Object(a.useEffect)((function(){f(1)}),[]),Object(a.useEffect)((function(){console.log(n),O()}),[n]);var f=function(e){fetch("/api/getbikedata?id=".concat(encodeURIComponent(e))).then((function(e){return e.json()})).then((function(e){c(e)}))},O=function(){fetch("/api/solve?bike_data=".concat(encodeURIComponent(JSON.stringify(n)),"&sim_travel=").concat(encodeURIComponent(170),"&desired_outputs=").concat(encodeURIComponent(JSON.stringify(h)))).then((function(e){return e.json()})).then((function(e){return l(e)}))};return Object(g.jsx)("div",{className:"App",children:Object(g.jsxs)("div",{class:"grid-container",children:[Object(g.jsx)(B,{fetchBikeData:f,setDebug:b,debug:j}),Object(g.jsx)("div",{class:"left",children:Object(g.jsx)(F,{bikeData:n,setBikeData:c,clearBikeData:function(){c(null)},clearSolutionData:function(){l({})},debug:j})}),Object(g.jsx)("div",{class:"right",children:Object(g.jsx)(x,{data:s,leverage_ratio_key:h[0],anti_squat_key:h[1],travel_key:h[2]})})]})})},E=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,322)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,r=t.getLCP,o=t.getTTFB;n(e),a(e),c(e),r(e),o(e)}))};o.a.render(Object(g.jsx)(c.a.StrictMode,{children:Object(g.jsx)(A,{})}),document.getElementById("root")),E()},73:function(e,t,n){}},[[313,1,2]]]);
//# sourceMappingURL=main.9eec724f.chunk.js.map